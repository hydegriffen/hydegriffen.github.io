<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>CHAINS â€” Daily Word Puzzle</title>
<meta name="description" content="Find the hidden words that connect the chain. A new puzzle every day.">
<meta name="theme-color" content="#F6F3EE" id="metaTheme">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root,[data-theme="light"]{--bg:#F6F3EE;--bg-raised:#FFF;--bg-slot:#EDE9E1;--border:#DDD8CE;--text:#2C2926;--text-dim:#7A756D;--text-faint:#ADA89F;--accent:#B8860B;--accent-dim:#9A7209;--correct:#3A8A52;--correct-bg:#E6F4EB;--correct-border:rgba(58,138,82,.35);--close:#B8860B;--close-bg:#FFF6E0;--close-border:rgba(184,134,11,.3);--wrong:#C44040;--wrong-bg:#FDECEC;--wrong-border:rgba(196,64,64,.2);--chain-link:#CCC7BD;--slot-active:#B8860B;--overlay-bg:rgba(40,38,35,.45);--modal-bg:#FFF;--modal-border:#E8E4DC;--input-bg:#FFF;--stat-bg:#F0ECE5;--dist-bar:#DDD8CE;--dist-text:#2C2926;--share-btn:#3A8A52;--toast-bg:#2C2926;--toast-text:#F6F3EE;--shadow-sm:0 1px 3px rgba(0,0,0,.06);--shadow-md:0 4px 16px rgba(0,0,0,.08);--shadow-lg:0 8px 32px rgba(0,0,0,.12);--btn-text:#fff}
[data-theme="dark"]{--bg:#111015;--bg-raised:#1A1820;--bg-slot:#222028;--border:#2A2830;--text:#EDE6D8;--text-dim:#8A8690;--text-faint:#5A5660;--accent:#D4A843;--accent-dim:#7A6A30;--correct:#4CAF68;--correct-bg:#1a3025;--correct-border:rgba(76,175,104,.3);--close:#C9A228;--close-bg:#2a2518;--close-border:rgba(201,162,40,.3);--wrong:#C44D4D;--wrong-bg:#2a1818;--wrong-border:rgba(196,77,77,.2);--chain-link:#3A3640;--slot-active:#D4A843;--overlay-bg:rgba(10,10,15,.85);--modal-bg:#1A1820;--modal-border:#2A2830;--input-bg:#1A1820;--stat-bg:#111015;--dist-bar:#2A2830;--dist-text:#111015;--share-btn:#4CAF68;--toast-bg:#EDE6D8;--toast-text:#111015;--shadow-sm:0 1px 3px rgba(0,0,0,.2);--shadow-md:0 4px 16px rgba(0,0,0,.3);--shadow-lg:0 8px 32px rgba(0,0,0,.4);--btn-text:#111015}
html,body{background:var(--bg);color:var(--text);font-family:'Nunito',sans-serif;min-height:100dvh;overflow-x:hidden;-webkit-tap-highlight-color:transparent;transition:background .35s,color .35s}
body{display:flex;flex-direction:column;align-items:center;padding:0 16px}
header{width:100%;max-width:500px;display:flex;align-items:center;justify-content:space-between;padding:14px 0 10px;border-bottom:1px solid var(--border)}
.logo{font-family:'Playfair Display',serif;font-weight:900;font-size:26px;letter-spacing:4px;color:var(--accent);text-transform:uppercase;user-select:none}
.logo span{display:inline-block;animation:logoIn .5s cubic-bezier(.34,1.56,.64,1) both}
@keyframes logoIn{from{opacity:0;transform:translateY(-10px) scale(.8)}to{opacity:1;transform:translateY(0) scale(1)}}
.header-actions{display:flex;gap:6px}
.icon-btn{background:none;border:1px solid var(--border);color:var(--text-dim);width:36px;height:36px;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;font-size:16px}
.icon-btn:hover{border-color:var(--text-dim);color:var(--text)}.icon-btn:active{transform:scale(.92)}
.theme-toggle{position:relative;overflow:hidden}.theme-toggle svg{transition:transform .3s,opacity .3s}
[data-theme="dark"] .icon-sun{opacity:1;transform:rotate(0)}[data-theme="dark"] .icon-moon{opacity:0;transform:rotate(-90deg);position:absolute}
[data-theme="light"] .icon-sun{opacity:0;transform:rotate(90deg);position:absolute}[data-theme="light"] .icon-moon{opacity:1;transform:rotate(0)}
.puzzle-label{text-align:center;padding:14px 0 4px;font-size:13px;font-weight:600;color:var(--text-dim);letter-spacing:2px;text-transform:uppercase}
.chain-container{width:100%;max-width:500px;padding:18px 0 12px;display:flex;align-items:center;justify-content:center;gap:0;flex-wrap:nowrap}
.chain-slot{display:flex;flex-direction:column;align-items:center;gap:4px;flex:1;min-width:0;cursor:default;animation:slotIn .4s cubic-bezier(.34,1.56,.64,1) both}
.chain-slot:nth-child(1){animation-delay:0s}.chain-slot:nth-child(3){animation-delay:.06s}.chain-slot:nth-child(5){animation-delay:.12s}.chain-slot:nth-child(7){animation-delay:.18s}.chain-slot:nth-child(9){animation-delay:.24s}
@keyframes slotIn{from{opacity:0;transform:scale(.7)}to{opacity:1;transform:scale(1)}}
.slot-card{width:100%;aspect-ratio:1.2;max-height:72px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-family:'Nunito',sans-serif;font-weight:800;font-size:clamp(11px,3.2vw,16px);text-transform:uppercase;letter-spacing:1px;transition:all .3s cubic-bezier(.34,1.56,.64,1);position:relative;overflow:hidden;user-select:none;box-shadow:var(--shadow-sm)}
.slot-card.revealed{background:var(--bg-raised);border:1px solid var(--border);color:var(--text)}
.slot-card.hidden{background:var(--bg-slot);border:2px dashed var(--chain-link);color:var(--text-faint);cursor:pointer;font-size:clamp(16px,4vw,22px);box-shadow:none}
.slot-card.hidden:hover{border-color:var(--accent-dim)}
.slot-card.hidden.active{border:2px solid var(--slot-active);box-shadow:0 0 20px rgba(184,134,11,.12)}
[data-theme="dark"] .slot-card.hidden.active{box-shadow:0 0 20px rgba(212,168,67,.15)}
.slot-card.solved{border:2px solid var(--correct);background:var(--correct-bg);color:var(--correct);animation:solveReveal .5s cubic-bezier(.34,1.56,.64,1);box-shadow:none}
@keyframes solveReveal{0%{transform:scale(.5) rotateY(90deg);opacity:0}50%{transform:scale(1.15) rotateY(0);opacity:1}100%{transform:scale(1) rotateY(0)}}
.slot-number{font-size:10px;font-weight:700;color:var(--text-faint);letter-spacing:1px}
.chain-link{display:flex;align-items:center;justify-content:center;width:14px;flex-shrink:0;color:var(--chain-link);font-size:10px;padding-bottom:16px}
.chain-link svg{width:14px;height:14px}.chain-link.linked svg{color:var(--correct)}
.input-area{width:100%;max-width:500px;padding:16px 0}
.input-instruction{text-align:center;font-size:13px;color:var(--text-dim);margin-bottom:10px;min-height:20px}
.input-row{display:flex;gap:8px;align-items:center}
.guess-input{flex:1;background:var(--input-bg);border:2px solid var(--border);color:var(--text);font-family:'Nunito',sans-serif;font-weight:700;font-size:18px;padding:12px 16px;border-radius:12px;outline:none;text-transform:uppercase;letter-spacing:2px;transition:border-color .2s;box-shadow:var(--shadow-sm)}
.guess-input:focus{border-color:var(--accent)}.guess-input::placeholder{color:var(--text-faint);font-weight:400;letter-spacing:0;text-transform:none;font-size:15px}.guess-input:disabled{opacity:.4;cursor:not-allowed}
.submit-btn{background:var(--accent);color:var(--btn-text);border:none;font-family:'Nunito',sans-serif;font-weight:800;font-size:15px;padding:12px 20px;border-radius:12px;cursor:pointer;transition:all .2s;white-space:nowrap;box-shadow:var(--shadow-sm)}
.submit-btn:hover{filter:brightness(1.1)}.submit-btn:active{transform:scale(.95)}.submit-btn:disabled{opacity:.3;cursor:not-allowed}
.guess-counter{text-align:center;padding:8px 0;font-size:13px;color:var(--text-dim);font-weight:600}.guess-counter .remaining{color:var(--accent);font-weight:800}
.guess-history{width:100%;max-width:500px;display:flex;flex-direction:column;gap:6px;padding-bottom:20px}
.guess-entry{display:flex;align-items:center;gap:10px;padding:8px 14px;border-radius:10px;font-size:14px;font-weight:600;animation:guessSlide .3s cubic-bezier(.34,1.56,.64,1)}
@keyframes guessSlide{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}
.guess-entry.correct{background:var(--correct-bg);border:1px solid var(--correct-border)}.guess-entry.close{background:var(--close-bg);border:1px solid var(--close-border)}.guess-entry.wrong{background:var(--wrong-bg);border:1px solid var(--wrong-border)}
.guess-emoji{font-size:16px}.guess-word{flex:1;text-transform:uppercase;letter-spacing:1px}.guess-slot{font-size:11px;color:var(--text-dim);font-weight:400}.guess-hint{font-size:11px;color:var(--text-dim);font-weight:400;font-style:italic}
.overlay{position:fixed;inset:0;background:var(--overlay-bg);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);z-index:100;display:none;align-items:center;justify-content:center;padding:20px;animation:fadeIn .3s}.overlay.show{display:flex}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.modal{background:var(--modal-bg);border:1px solid var(--modal-border);border-radius:20px;padding:28px 24px;width:100%;max-width:380px;max-height:90dvh;overflow-y:auto;animation:modalIn .4s cubic-bezier(.34,1.56,.64,1);box-shadow:var(--shadow-lg)}
@keyframes modalIn{from{opacity:0;transform:scale(.85) translateY(20px)}to{opacity:1;transform:scale(1) translateY(0)}}
.modal-close{float:right;background:none;border:none;color:var(--text-dim);font-size:22px;cursor:pointer;padding:0 0 8px 8px;line-height:1}.modal-close:hover{color:var(--text)}
.modal h2{font-family:'Playfair Display',serif;font-size:22px;color:var(--accent);margin-bottom:16px}
.modal h3{font-size:13px;color:var(--text-dim);font-weight:700;letter-spacing:2px;text-transform:uppercase;margin:20px 0 10px}
.result-chain{display:flex;align-items:center;justify-content:center;gap:3px;margin:12px 0 8px;flex-wrap:wrap}
.result-word{padding:3px 6px;border-radius:6px;font-weight:700;font-size:11px;text-transform:uppercase;letter-spacing:0.5px}
.result-word.given{background:var(--bg-slot);color:var(--text-dim)}.result-word.found{background:var(--correct-bg);color:var(--correct);border:1px solid var(--correct-border)}.result-word.missed{background:var(--wrong-bg);color:var(--wrong);border:1px solid var(--wrong-border)}
.result-arrow{color:var(--text-faint);font-size:12px}.result-message{text-align:center;font-size:20px;font-weight:800;margin:10px 0}
.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin:10px 0}
.stat-item{text-align:center;padding:10px 4px;background:var(--stat-bg);border-radius:10px}.stat-value{font-size:22px;font-weight:800;color:var(--text)}.stat-label{font-size:10px;color:var(--text-dim);font-weight:600;text-transform:uppercase;letter-spacing:.5px;margin-top:2px}
.dist-row{display:flex;align-items:center;gap:6px;margin:3px 0}.dist-label{font-size:12px;font-weight:700;width:14px;text-align:center;color:var(--text-dim)}
.dist-bar{height:22px;border-radius:4px;background:var(--dist-bar);min-width:24px;display:flex;align-items:center;justify-content:flex-end;padding:0 6px;font-size:11px;font-weight:700;color:var(--dist-text);transition:width .6s cubic-bezier(.34,1.56,.64,1)}.dist-bar.highlight{background:var(--correct);color:#fff}
.share-btn{width:100%;background:var(--share-btn);color:#fff;border:none;font-family:'Nunito',sans-serif;font-weight:800;font-size:16px;padding:14px;border-radius:12px;cursor:pointer;margin-top:16px;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:8px}
.share-btn:hover{filter:brightness(1.1)}.share-btn:active{transform:scale(.97)}.share-btn.copied{background:var(--accent)}
.how-section{margin:10px 0}.how-example{background:var(--stat-bg);border-radius:10px;padding:14px;margin:10px 0}
.how-chain{display:flex;align-items:center;justify-content:center;gap:2px;font-weight:700;font-size:11px;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:8px}
.how-word{padding:3px 6px;border-radius:4px}.how-word.given{background:var(--bg-slot);color:var(--text-dim)}.how-word.answer{background:var(--correct-bg);color:var(--correct)}
.how-text{font-size:14px;line-height:1.6;color:var(--text)}.how-text p{margin:8px 0}
.how-feedback{display:flex;flex-direction:column;gap:6px;margin:10px 0}.how-fb-row{display:flex;align-items:center;gap:8px;font-size:13px}
.how-fb-emoji{font-size:16px;width:24px;text-align:center}.how-fb-text{color:var(--text-dim)}
.confetti-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:200;overflow:hidden}
.confetti-piece{position:absolute;width:8px;height:8px;top:-10px;animation:confettiFall linear forwards}
@keyframes confettiFall{0%{transform:translateY(0) rotate(0) scale(1);opacity:1}80%{opacity:1}100%{transform:translateY(100vh) rotate(720deg) scale(.3);opacity:0}}
.toast{position:fixed;top:60px;left:50%;transform:translateX(-50%) translateY(-20px);background:var(--toast-bg);color:var(--toast-text);padding:10px 20px;border-radius:10px;font-weight:700;font-size:14px;z-index:300;opacity:0;transition:all .3s cubic-bezier(.34,1.56,.64,1);pointer-events:none;box-shadow:var(--shadow-md)}.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.next-puzzle{text-align:center;margin-top:12px;font-size:13px;color:var(--text-dim)}.next-puzzle .timer{font-family:'Nunito',sans-serif;font-weight:800;font-size:20px;color:var(--accent);letter-spacing:2px}
@media(max-width:380px){.slot-card{max-height:60px;font-size:10px}.chain-link{width:10px}.stats-grid{grid-template-columns:repeat(2,1fr)}}
@media(min-width:600px){.slot-card{max-height:80px}}
</style>
</head>
<body>
<div class="toast" id="toast"></div>
<header>
<div class="logo"><span style="animation-delay:0s">C</span><span style="animation-delay:.04s">H</span><span style="animation-delay:.08s">A</span><span style="animation-delay:.12s">I</span><span style="animation-delay:.16s">N</span><span style="animation-delay:.20s">S</span></div>
<div class="header-actions">
<button class="icon-btn" onclick="showHelp()" title="How to play">?</button>
<button class="icon-btn" onclick="showStats()" title="Statistics"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><rect x="4" y="14" width="4" height="7"/><rect x="10" y="9" width="4" height="12"/><rect x="16" y="4" width="4" height="17"/></svg></button>
<button class="icon-btn theme-toggle" onclick="toggleTheme()" title="Toggle theme"><svg class="icon-sun" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg><svg class="icon-moon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></button>
</div>
</header>
<div class="puzzle-label" id="puzzleLabel">Chain #1</div>
<div class="chain-container" id="chainContainer"></div>
<div class="guess-counter" id="guessCounter"></div>
<div class="input-area" id="inputArea">
<div class="input-instruction" id="inputInstruction">Tap a slot to start guessing</div>
<div class="input-row">
<input type="text" class="guess-input" id="guessInput" placeholder="Type your guess..." maxlength="20" autocomplete="off" autocapitalize="none" spellcheck="false" disabled>
<button class="submit-btn" id="submitBtn" onclick="submitGuess()" disabled>GO</button>
</div></div>
<div class="guess-history" id="guessHistory"></div>
<div class="overlay" id="resultsOverlay"><div class="modal" id="resultsModal"></div></div>
<div class="overlay" id="statsOverlay"><div class="modal" id="statsModal"></div></div>
<div class="overlay" id="helpOverlay"><div class="modal" id="helpModal"></div></div>
<div class="confetti-container" id="confetti"></div>
<script>
function getTheme(){return localStorage.getItem('chain_theme')||'light'}
function applyTheme(t){document.documentElement.setAttribute('data-theme',t);document.getElementById('metaTheme').content=t==='dark'?'#111015':'#F6F3EE';localStorage.setItem('chain_theme',t)}
function toggleTheme(){applyTheme(document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark')}
applyTheme(getTheme());
const PUZZLES=[["short", "hand", "off", "set", "back"], ["cut", "out", "play", "off", "hand"], ["camp", "fire", "work", "man", "power"], ["cut", "back", "hand", "out", "set"], ["field", "day", "break", "out", "play"], ["black", "out", "field", "day", "bed"], ["bed", "head", "lock", "out", "field"], ["cross", "cut", "out", "house", "work"], ["free", "fall", "out", "side", "line"], ["short", "cut", "back", "hand", "ball"], ["short", "cut", "back", "side", "arm"], ["cut", "out", "play", "back", "fire"], ["day", "time", "out", "door", "lock"], ["free", "fall", "out", "door", "lock"], ["short", "cut", "back", "door", "step"], ["black", "out", "field", "work", "bench"], ["down", "fall", "back", "side", "arm"], ["head", "lock", "down", "play", "back"], ["day", "break", "out", "play", "room"], ["camp", "out", "house", "work", "room"], ["down", "play", "back", "hand", "ball"], ["bath", "water", "bed", "time", "lock"], ["corn", "field", "work", "out", "play"], ["day", "time", "out", "house", "work"], ["farm", "work", "out", "field", "day"], ["head", "lock", "out", "field", "day"], ["free", "fall", "out", "board", "game"], ["fire", "break", "down", "play", "back"], ["back", "fire", "break", "down", "field"], ["fire", "wood", "cut", "off", "hand"], ["flash", "back", "fire", "arm", "chair"], ["half", "back", "side", "arm", "chair"], ["camp", "out", "house", "cat", "tail"], ["black", "out", "side", "show", "room"], ["post", "war", "time", "lock", "out"], ["flash", "back", "fire", "wall", "board"], ["head", "lock", "down", "turn", "table"], ["over", "head", "stand", "out", "set"], ["dog", "wood", "work", "book", "mark"], ["bull", "dog", "house", "work", "out"], ["fire", "power", "cut", "back", "board"], ["base", "camp", "out", "house", "work"], ["over", "turn", "out", "board", "game"], ["flash", "back", "fire", "power", "boat"], ["news", "flash", "back", "fire", "arm"], ["gun", "boat", "house", "work", "out"], ["camp", "fire", "house", "boat", "load"], ["air", "head", "stone", "work", "bench"], ["base", "camp", "fire", "house", "boat"], ["head", "count", "down", "field", "day"], ["bed", "post", "war", "time", "line"], ["bath", "house", "cat", "tail", "bone"], ["gun", "boat", "house", "cat", "tail"], ["cat", "fish", "bone", "head", "light"], ["cross", "road", "work", "bench", "mark"], ["fire", "power", "boat", "house", "cat"], ["off", "white", "water", "gate", "post"], ["bull", "ring", "road", "show", "boat"], ["sun", "day", "time", "out", "break"], ["sun", "day", "bed", "room", "mate"], ["sun", "day", "bed", "time", "line"], ["truck", "bed", "time", "out", "break"], ["truck", "bed", "post", "war", "ship"], ["under", "cut", "off", "set", "back"], ["under", "cut", "off", "side", "walk"], ["play", "off", "hand", "gun", "fire"], ["play", "off", "hand", "out", "break"], ["hand", "off", "cut", "out", "break"], ["hand", "gun", "fire", "man", "kind"], ["hand", "out", "door", "man", "kind"], ["hand", "out", "post", "war", "ship"], ["hand", "out", "set", "back", "fire"], ["back", "hand", "out", "set", "up"], ["back", "hand", "off", "cut", "out"], ["fire", "work", "out", "set", "back"], ["fire", "work", "day", "bed", "room"], ["down", "fall", "out", "set", "back"], ["down", "play", "off", "set", "back"], ["down", "play", "day", "bed", "room"], ["post", "war", "head", "set", "back"], ["post", "war", "lock", "out", "break"], ["fire", "work", "out", "break", "down"], ["fire", "work", "out", "door", "bell"], ["fire", "work", "out", "side", "walk"], ["fire", "work", "out", "post", "card"], ["fire", "work", "out", "play", "ground"], ["fire", "work", "bench", "mark", "down"], ["fire", "work", "day", "break", "out"], ["fire", "work", "day", "light", "house"], ["fire", "work", "day", "time", "line"], ["fire", "work", "horse", "back", "bone"], ["fire", "work", "horse", "play", "house"], ["fire", "house", "work", "bench", "mark"], ["fire", "house", "work", "day", "break"], ["fire", "house", "work", "horse", "back"], ["fire", "house", "work", "man", "kind"], ["fire", "house", "work", "room", "mate"], ["fire", "light", "house", "work", "shop"], ["fire", "break", "down", "fall", "out"], ["fire", "break", "down", "side", "walk"]];
const VALIDATION={"fire": ["truck", "work", "place", "side", "fly", "arm", "ball", "house", "man", "wood", "wall", "light", "proof", "fight", "storm", "crack", "bird", "pit", "power", "bomb", "break", "plug"], "back": ["hand", "fire", "bone", "yard", "pack", "board", "door", "drop", "field", "ground", "lash", "log", "side", "space", "stage", "track", "up", "flip", "seat", "spin", "stroke", "stab"], "hand": ["shake", "bag", "ball", "book", "cuff", "gun", "made", "out", "print", "rail", "stand", "writing", "work", "hold", "set", "craft", "off", "cart"], "shake": ["down", "out", "up"], "down": ["hill", "town", "fall", "load", "pour", "side", "stairs", "stream", "time", "turn", "wind", "grade", "play", "right", "swing", "beat", "field", "range", "size"], "hill": ["side", "top", "billy"], "stop": ["watch", "light", "gap", "over", "page"], "watch": ["tower", "dog", "man", "word", "band", "maker"], "tower": ["block", "head"], "truck": ["stop", "load", "bed"], "water": ["fall", "front", "mark", "melon", "proof", "shed", "side", "way", "color", "bed", "bird", "line", "log", "wheel", "work", "gate", "tight"], "rain": ["bow", "coat", "drop", "fall", "forest", "storm", "water", "check", "out", "maker", "check", "coat"], "sun": ["light", "flower", "burn", "rise", "set", "shine", "screen", "spot", "stroke", "roof", "beam", "dial", "glasses", "bath", "block", "day", "fish", "tan"], "moon": ["light", "shine", "beam", "walk", "stone", "rise", "lit"], "star": ["light", "fish", "dust", "board", "ship", "burst", "gate", "struck"], "snow": ["ball", "board", "drift", "fall", "flake", "man", "plow", "shoe", "storm", "drop", "cap", "field", "bird"], "ice": ["berg", "cap", "cream", "breaker", "box", "pick", "cold"], "wind": ["mill", "shield", "fall", "pipe", "storm", "screen", "break", "burn", "swept", "sock"], "sand": ["box", "castle", "paper", "stone", "storm", "bag", "bar", "pit", "bank", "man"], "sea": ["shell", "shore", "horse", "food", "port", "side", "weed", "bed", "bird", "wall", "water", "sick", "gull", "man", "scape"], "land": ["mark", "lord", "slide", "mine", "fall", "fill", "lock", "line", "mass", "owner", "scape", "side", "lord"], "book": ["mark", "case", "end", "keeper", "shelf", "shop", "store", "worm", "let", "maker", "store"], "note": ["book", "pad", "worthy"], "blue": ["berry", "bird", "bell", "print", "grass", "tooth", "stone"], "black": ["berry", "bird", "board", "jack", "list", "mail", "out", "smith", "top", "hole", "eye"], "white": ["board", "wash", "out", "cap", "tail", "water", "fish", "house"], "red": ["wood", "head", "eye", "line", "cap", "skin", "coat"], "green": ["house", "back", "light", "horn", "field", "room"], "gold": ["fish", "mine", "rush", "smith", "field", "finch"], "head": ["band", "board", "first", "light", "line", "long", "master", "phone", "quarter", "room", "set", "stand", "start", "stone", "strong", "way", "count", "dress", "land", "lock", "rest", "hunt", "gear"], "over": ["head", "board", "coat", "come", "flow", "look", "night", "power", "run", "see", "shoot", "sight", "time", "turn", "weight", "load", "lap", "pass", "ride", "rule", "take", "throw", "haul", "hang", "land", "due", "all", "cast", "dose", "draw", "drive", "grow", "heat", "joy", "kill", "play", "price", "rate", "react", "step"], "out": ["break", "come", "door", "field", "fit", "grow", "law", "let", "line", "look", "number", "put", "rage", "reach", "run", "side", "smart", "spoken", "take", "weigh", "post", "cast", "fox", "house", "land", "play", "right", "set", "shine", "skirt", "burst", "bid", "board", "bound", "crop"], "under": ["cover", "cut", "dog", "foot", "go", "ground", "growth", "line", "mine", "pass", "score", "side", "stand", "take", "tone", "water", "wear", "world", "age", "belly", "bid", "class", "current"], "light": ["house", "weight", "year", "ship", "bulb", "ning"], "night": ["fall", "cap", "club", "gown", "life", "mare", "stand", "time", "shift", "hawk", "light"], "day": ["break", "dream", "light", "time", "care", "bed", "pack", "care"], "time": ["line", "table", "out", "piece", "stamp", "keeper", "frame", "share", "zone", "bomb", "lapse", "lock", "work", "span"], "work": ["shop", "out", "load", "place", "force", "bench", "book", "day", "flow", "horse", "man", "room", "space", "station"], "house": ["hold", "keeper", "wife", "work", "boat", "top", "plant", "cat", "fly", "fire", "coat", "bound", "break", "warm"], "home": ["work", "sick", "town", "land", "made", "coming", "run", "base", "body", "bound", "brew", "buyer", "page", "room", "stand", "stead", "stretch", "ward"], "school": ["house", "work", "yard", "boy", "girl", "master", "room", "bus", "bag", "book", "master"], "road": ["block", "house", "kill", "map", "runner", "side", "show", "way", "work", "trip"], "cross": ["road", "bow", "word", "bar", "check", "fire", "over", "walk", "wind", "bone", "cut", "fit", "hair", "town"], "door": ["bell", "knob", "mat", "step", "stop", "way", "man", "frame", "lock", "post"], "wall": ["paper", "flower", "board"], "floor": ["board", "plan", "show"], "horse": ["back", "fly", "play", "power", "shoe", "tail", "man", "hair", "hide", "whip", "meat", "radish"], "bull": ["dog", "ring", "pen", "horn", "fight", "eye", "frog", "rush", "head"], "dog": ["house", "wood", "fight", "fish", "leg", "watch", "tag", "ear"], "cat": ["fish", "walk", "nap", "call", "suit", "tail"], "fish": ["bone", "bowl", "cake", "hook", "net", "pond", "tail", "wife", "eye", "man", "monger"], "foot": ["ball", "bridge", "hill", "hold", "note", "path", "print", "rest", "step", "stool", "wear", "work", "board", "light", "man"], "stone": ["wall", "work", "cold", "mason", "fish", "ground", "ware"], "rock": ["fall", "slide", "bottom", "fish", "bed", "star"], "wood": ["land", "work", "pecker", "cut", "chip", "shed", "pile"], "tree": ["top", "house", "line"], "play": ["ground", "house", "mate", "off", "pen", "room", "thing", "time", "wright", "back", "book", "field", "bill", "boy", "day"], "game": ["play", "plan", "board", "day", "show", "keeper", "master"], "ball": ["game", "park", "room", "point", "player"], "basket": ["ball", "case", "work"], "base": ["ball", "board", "camp", "line", "man", "ment"], "goal": ["keeper", "post", "line"], "score": ["board", "card", "keeper", "line"], "cup": ["board", "cake", "bearer"], "tea": ["cup", "pot", "room", "spoon", "time", "house", "bag", "cake", "leaf", "kettle"], "pot": ["hole", "luck", "plant", "belly"], "pan": ["cake", "handle"], "cake": ["walk"], "cook": ["book", "out", "top", "ware"], "dust": ["bin", "pan", "storm", "man", "coat", "cart"], "air": ["port", "line", "craft", "field", "force", "lift", "mail", "plane", "ship", "strip", "tight", "way", "lock", "bag", "base", "born", "brush", "drop", "flow", "head", "gun", "sick", "space", "wave"], "sky": ["line", "light", "dive", "lark", "rocket", "scraper", "ward", "walk"], "cloud": ["burst", "cover"], "ground": ["work", "floor", "water", "hog", "break", "keeper", "swell", "nut"], "spring": ["board", "time", "water", "field", "back", "clean", "board"], "fall": ["back", "out"], "heart": ["beat", "break", "burn", "land", "felt", "sick", "string", "warm", "wood", "throb", "ache"], "eye": ["ball", "brow", "drop", "lash", "lid", "sight", "witness", "sore", "piece", "glass", "liner", "wear", "shadow"], "brain": ["storm", "wash", "wave", "child", "dead", "power", "teaser"], "arm": ["band", "chair", "pit", "rest", "lock", "guard"], "blood": ["hound", "line", "shed", "shot", "stream", "bath", "stain", "stone"], "tooth": ["brush", "ache", "pick", "paste"], "finger": ["print", "tip", "nail", "board"], "nail": ["bed", "brush", "gun", "head"], "thumb": ["nail", "tack", "print", "screw", "nail"], "neck": ["lace", "line", "tie", "band"], "tail": ["gate", "bone", "coat", "light", "pipe", "spin", "wind"], "ship": ["yard", "load", "wreck", "board", "mate", "shape", "builder"], "boat": ["house", "load", "man", "yard", "race", "swing"], "sail": ["boat", "fish", "cloth", "maker"], "port": ["hole", "side", "folio"], "hard": ["ball", "board", "core", "cover", "ship", "ware", "wood", "back", "court", "line", "pan", "top", "wire", "hat"], "soft": ["ball", "ware", "wood", "back", "cover", "top"], "long": ["bow", "horn", "house", "range", "shore", "shot", "hand", "boat", "arm"], "short": ["cut", "hand", "list", "stop", "cake", "fall", "wave", "change", "sight"], "high": ["ball", "chair", "land", "light", "road", "way", "jack", "rise", "wire", "life", "born", "top"], "low": ["ball", "land", "life", "light", "down", "rider", "key"], "half": ["back", "time", "way", "heart", "pipe", "tone", "life"], "double": ["back", "check", "cross", "take", "time", "header", "dutch"], "side": ["walk", "line", "show", "step", "track", "car", "kick", "arm", "board", "burn", "light", "man", "stroke", "bar", "swipe", "wind"], "step": ["child", "father", "mother", "brother", "ladder", "stone", "son", "daughter"], "ring": ["leader", "master", "side", "tone", "worm", "road"], "chain": ["link", "saw", "mail", "smoke", "gang"], "link": ["up", "age"], "key": ["board", "chain", "hole", "note", "stone", "word", "pad", "ring", "stroke", "lock"], "lock": ["down", "out", "smith", "jaw", "step", "box"], "gate": ["way", "house", "keeper", "crash", "post"], "path": ["way", "finder"], "way": ["side", "point", "lay"], "wheel": ["house", "chair", "base", "barrow", "wright"], "cart": ["wheel", "horse", "load"], "car": ["pool", "port", "wash", "go", "jack", "load", "pet", "sick"], "drive": ["way", "shaft", "through"], "speed": ["boat", "way", "well", "bump"], "power": ["house", "line", "plant", "play", "boat", "cut", "lift", "train", "grid"], "steam": ["boat", "roll", "ship", "pipe", "engine"], "iron": ["work", "wood", "stone", "man", "clad", "monger"], "steel": ["work", "yard", "worker"], "coal": ["field", "mine", "man", "mine"], "glass": ["ware", "house", "work", "blower"], "box": ["car", "office", "room", "set"], "paper": ["back", "board", "boy", "clip", "weight", "work", "trail", "mill"], "news": ["paper", "room", "cast", "letter", "stand", "man", "print", "reel", "feed", "flash"], "mail": ["box", "bag", "man", "room", "drop"], "post": ["card", "man", "mark", "master", "office", "box", "game", "war", "script", "season"], "silver": ["fish", "smith", "ware", "back", "side", "screen", "tongue"], "store": ["house", "room", "front", "keeper"], "shop": ["keeper", "floor", "lift", "front", "girl"], "field": ["work", "stone", "goal", "house", "trip", "day", "mouse"], "farm": ["house", "land", "yard", "hand", "work", "stead"], "corn": ["field", "flower", "meal", "stone", "starch", "bread", "row", "bread"], "milk": ["man", "maid", "shake", "weed", "stone"], "honey": ["bee", "comb", "moon", "dew", "pot", "suckle"], "bee": ["hive", "line", "wax", "keeper", "sting"], "butter": ["cup", "fly", "milk", "scotch", "cream", "ball", "finger", "nut"], "nut": ["shell", "house", "case", "crack", "hatch", "meg"], "shell": ["fire", "fish", "shock"], "crack": ["down", "pot", "jack", "er"], "break": ["away", "down", "fast", "neck", "out", "through", "up", "water", "point", "even", "bone"], "match": ["box", "stick", "maker", "book", "play", "point"], "stick": ["ball", "man"], "broad": ["band", "cast", "side", "sword", "sheet", "way"], "band": ["stand", "wagon", "width", "master", "leader"], "drum": ["stick", "beat", "roll", "line", "fire", "head", "mer"], "song": ["bird", "book", "writer", "line"], "birth": ["day", "mark", "place", "right", "stone", "rate"], "death": ["bed", "trap", "wish", "blow", "toll", "match"], "war": ["ship", "time", "horse", "head", "lord", "path", "zone", "game", "fare", "lock"], "gun": ["fire", "powder", "ship", "shot", "smith", "fight", "man", "boat", "point", "metal"], "bow": ["man", "string"], "sword": ["fish", "play", "smith", "man"], "blade": ["runner", "bone"], "sharp": ["shoot", "shooter"], "point": ["blank", "guard", "man"], "line": ["back", "man", "up", "backer"], "face": ["book", "lift", "off", "plate", "down", "mask", "paint", "time", "palm"], "life": ["boat", "guard", "line", "long", "span", "style", "time", "blood", "like", "saver", "size", "work"], "master": ["mind", "piece", "plan", "work", "class", "stroke"], "mind": ["set", "field", "full", "storm", "map", "less"], "class": ["mate", "room", "work"], "room": ["mate"], "bed": ["room", "time", "rock", "side", "bug", "post", "spread", "head", "roll", "post"], "river": ["bed", "bank", "side", "boat", "front"], "lake": ["front", "side", "shore", "bed"], "bridge": ["head", "work"], "table": ["top", "cloth", "spoon", "land", "ware"], "chair": ["man", "lift", "back", "person"], "bench": ["mark", "press", "top", "warm"], "mark": ["down", "up", "man", "sheet", "time"], "sign": ["board", "post", "off", "up"], "pin": ["ball", "hole", "point", "stripe", "wheel", "cushion", "head"], "spin": ["off"], "turn": ["over", "pike", "around", "out", "table", "coat", "key", "buckle", "style", "stile"], "count": ["down", "back", "part"], "lap": ["top", "dog"], "pit": ["fall", "stop", "bull", "fork"], "camp": ["fire", "ground", "site", "out"], "wild": ["fire", "life", "cat", "card", "flower", "west"], "ever": ["green", "more", "last"], "ear": ["ring", "drum", "phone", "plug", "mark", "wig", "piece", "worm", "bud"], "stair": ["case", "way", "well"], "wire": ["less", "tap"], "frame": ["work"], "pole": ["star", "cat", "star"], "stage": ["coach", "hand", "craft"], "rush": ["hour"], "care": ["free", "taker", "giver", "free"], "free": ["way", "dom", "lance", "load", "fall", "hold", "hand", "range", "style", "ware", "wheel"], "stand": ["off", "out", "point", "still", "pipe", "by", "up", "alone"], "flash": ["back", "light", "point", "card", "mob", "flood", "gun"], "end": ["game", "zone", "line", "note"], "net": ["work", "ball"], "web": ["master", "page", "site", "cam", "foot"], "tool": ["box", "bar", "kit", "shed", "belt"], "hay": ["stack", "wire", "field", "maker", "ride", "loft"], "bare": ["foot", "back", "bone"], "bear": ["skin"], "board": ["room", "walk", "game", "house"], "grave": ["yard", "stone", "digger"], "cave": ["man"], "top": ["coat", "soil", "side", "knot", "spin", "notch"], "tip": ["off", "top", "toe", "off"], "lamp": ["light", "post", "shade"], "flag": ["pole", "ship", "stone", "staff"], "shoe": ["horn", "lace", "maker", "string", "box"], "boot": ["camp", "leg", "strap", "lace", "print"], "bone": ["fire", "head", "dry", "meal", "china"], "stock": ["room", "pile", "yard", "broker", "market", "pot", "car"], "round": ["house", "table", "up", "about", "worm"], "string": ["bean", "board", "bean", "board"], "wave": ["length", "band", "form"], "mine": ["field", "shaft", "cart", "sweep", "worker"], "shaft": ["head"], "spot": ["light", "check"], "sweat": ["band", "shop", "shirt", "pants"], "bath": ["room", "robe", "tub", "house", "water"], "show": ["room", "time", "down", "case", "man", "place", "boat", "ground", "piece", "girl"], "bank": ["roll", "note", "book", "rupt"], "pay": ["back", "check", "day", "load", "off", "roll", "master"], "check": ["list", "mark", "mate", "out", "point", "book", "up", "room", "board"], "fore": ["cast", "head", "man", "arm", "ground", "hand", "play", "runner", "see", "sight", "tell", "word", "front", "father", "finger", "foot"], "straw": ["berry"], "berry": ["field"], "guard": ["house", "rail", "room", "dog", "man"], "hot": ["dog", "shot", "bed", "house", "line", "spot", "pot", "cake", "rod", "head", "plate"], "cold": ["blood", "snap"], "storm": ["cloud", "water", "proof", "trooper"], "coat": ["rack", "room", "tail", "hanger"], "rack": ["ball"], "mat": ["board"], "clip": ["board"], "treasure": ["hunt", "chest"], "chest": ["nut", "board"], "trap": ["door", "shoot"], "draw": ["back", "bridge", "bar", "string", "down"], "crew": ["cut", "man"], "cut": ["back", "off", "out", "throat", "down", "away"], "pitch": ["fork"], "fork": ["lift"], "lift": ["off"], "park": ["land", "way"], "man": ["kind", "hole", "hunt", "power", "handle", "made", "slaughter"], "woman": ["kind", "hood"], "brother": ["hood"], "king": ["pin", "fish", "dom", "maker", "bird", "fisher"], "crown": ["bar"], "pig": ["tail", "pen"], "pen": ["knife", "man"], "cow": ["boy", "bell", "bird", "girl", "hide", "pox"], "ram": ["page", "part"], "page": ["boy"], "boy": ["friend", "hood"], "girl": ["friend", "hood"], "friend": ["ship"], "bread": ["basket", "crumb", "fruit", "winner", "box"], "dream": ["land", "boat", "team", "work", "catcher"], "bird": ["cage", "house", "bath", "seed", "song", "watch", "eye"], "nest": ["egg"], "egg": ["shell", "cup", "head", "plant", "nog"], "off": ["set", "side", "spring", "hand", "shoot", "shore", "load", "stage", "beat", "cut", "guard", "peak", "print", "ramp", "season", "screen", "track", "white", "end"], "set": ["back", "up"]};

const LAUNCH_DATE=new Date('2026-02-07T00:00:00');
const MAX_GUESSES=10;
const HIDDEN_SLOTS=[1,2,3];
const STORAGE_KEY='chain_game_v2';
let state={puzzleIndex:0,chain:[],solved:[false,false,false,false,false],guesses:[],activeSlot:null,gameOver:false,won:false,guessesUsed:0};
function getTodayPuzzleIndex(){const n=new Date(),t=new Date(n.getFullYear(),n.getMonth(),n.getDate()),d=Math.floor((t-LAUNCH_DATE)/864e5);return((d%PUZZLES.length)+PUZZLES.length)%PUZZLES.length}
function getTodayKey(){const n=new Date();return `${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,'0')}-${String(n.getDate()).padStart(2,'0')}`}
function loadGameState(){try{const r=localStorage.getItem(STORAGE_KEY);return r?JSON.parse(r):null}catch{return null}}
function saveGameState(){const d=loadGameState()||{},k=getTodayKey();d[k]={puzzleIndex:state.puzzleIndex,guesses:state.guesses,solved:state.solved,gameOver:state.gameOver,won:state.won,guessesUsed:state.guessesUsed};localStorage.setItem(STORAGE_KEY,JSON.stringify(d))}
function loadStats(){try{const r=localStorage.getItem('chain_stats_v3');return r?JSON.parse(r):getDefaultStats()}catch{return getDefaultStats()}}
function getDefaultStats(){return{played:0,won:0,currentStreak:0,maxStreak:0,guessDistribution:{3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0},lastPlayed:null}}
function saveStats(won,gu){const s=loadStats(),t=getTodayKey();if(s.lastPlayed===t)return;s.played++;if(won){s.won++;s.currentStreak++;s.maxStreak=Math.max(s.maxStreak,s.currentStreak);s.guessDistribution[Math.min(gu,8)]=(s.guessDistribution[Math.min(gu,8)]||0)+1}else{s.currentStreak=0}s.lastPlayed=t;localStorage.setItem('chain_stats_v3',JSON.stringify(s))}
function isValidCompound(a,b){const f=a.toLowerCase().trim(),s=b.toLowerCase().trim();return VALIDATION[f]&&VALIDATION[f].includes(s)}
function checkGuess(w,si){const g=w.toLowerCase().trim(),c=state.chain[si].toLowerCase();if(g===c)return'correct';const l=isValidCompound(state.chain[si-1],w),r=isValidCompound(w,state.chain[si+1]);return(l||r)?'close':'wrong'}
function renderChain(){const c=document.getElementById('chainContainer');c.innerHTML='';state.chain.forEach((word,i)=>{if(i>0){const lk=document.createElement('div');lk.className='chain-link';const bs=(state.solved[i-1]||i-1===0||i-1===4)&&(state.solved[i]||i===0||i===4);if(bs)lk.classList.add('linked');lk.innerHTML='<svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M6 4L4.5 5.5a3 3 0 000 4.24l.7.7M10 12l1.5-1.5a3 3 0 000-4.24l-.7-.7M5.5 10.5l5-5"/></svg>';c.appendChild(lk)}const s=document.createElement('div');s.className='chain-slot';const cd=document.createElement('div');const ih=HIDDEN_SLOTS.includes(i),is=state.solved[i];if(!ih){cd.className='slot-card revealed';cd.textContent=word}else if(is){cd.className='slot-card solved';cd.textContent=word}else{cd.className='slot-card hidden';if(state.activeSlot===i)cd.classList.add('active');cd.textContent='?';cd.onclick=()=>selectSlot(i)}const lb=document.createElement('div');lb.className='slot-number';lb.textContent=(ih&&!is)?`SLOT ${HIDDEN_SLOTS.indexOf(i)+1}`:'';s.appendChild(cd);s.appendChild(lb);c.appendChild(s)})}
function renderGuessCounter(){const e=document.getElementById('guessCounter');if(state.gameOver){e.innerHTML='';return}const r=MAX_GUESSES-state.guessesUsed,sv=state.solved.filter((s,i)=>HIDDEN_SLOTS.includes(i)&&s).length;e.innerHTML=`<span class="remaining">${r}</span> guess${r!==1?'es':''} remaining \u00b7 ${sv}/3 found`}
function renderGuessHistory(){const e=document.getElementById('guessHistory');e.innerHTML='';state.guesses.forEach((g,i)=>{const en=document.createElement('div');en.className=`guess-entry ${g.result}`;en.style.animationDelay=`${i*.05}s`;const em=g.result==='correct'?'\ud83d\udfe9':g.result==='close'?'\ud83d\udfe8':'\ud83d\udfe5';let h='';if(g.result==='close'){if(g.leftOk&&g.rightOk)h='connects both sides!?';else if(g.leftOk)h='works on the left \u2192';else if(g.rightOk)h='\u2190 works on the right'}en.innerHTML=`<span class="guess-emoji">${em}</span><span class="guess-word">${g.word}</span><span class="guess-slot">Slot ${HIDDEN_SLOTS.indexOf(g.slot)+1}</span>${h?`<span class="guess-hint">${h}</span>`:''}`;e.appendChild(en)})}
function updateInputState(){const inp=document.getElementById('guessInput'),btn=document.getElementById('submitBtn'),inst=document.getElementById('inputInstruction');if(state.gameOver){inp.disabled=true;btn.disabled=true;inst.textContent='';return}if(state.activeSlot===null){inp.disabled=true;btn.disabled=true;inst.textContent='Tap a slot to start guessing'}else{inp.disabled=false;btn.disabled=false;const sn=HIDDEN_SLOTS.indexOf(state.activeSlot)+1,li=state.activeSlot-1,ri=state.activeSlot+1;const ld=state.solved[li]?state.chain[li].toUpperCase():'???',rd=state.solved[ri]?state.chain[ri].toUpperCase():'???';inst.innerHTML=`Guessing <strong>Slot ${sn}</strong>: ${ld} \u2192 <strong style="color:var(--accent)">???</strong> \u2192 ${rd}`;inp.focus()}}
function selectSlot(i){if(state.gameOver||state.solved[i])return;state.activeSlot=i;renderChain();updateInputState();document.getElementById('guessInput').value='';document.getElementById('guessInput').focus()}
function submitGuess(){const inp=document.getElementById('guessInput'),w=inp.value.trim().toLowerCase();if(!w||state.activeSlot===null||state.gameOver)return;if(state.guesses.some(g=>g.word.toLowerCase()===w&&g.slot===state.activeSlot)){showToast('Already guessed that!');return}const si=state.activeSlot,res=checkGuess(w,si),lo=isValidCompound(state.chain[si-1],w),ro=isValidCompound(w,state.chain[si+1]);state.guesses.push({word:w,slot:si,result:res,leftOk:lo,rightOk:ro});state.guessesUsed++;if(res==='correct'){state.solved[si]=true;showToast([`Nice! \ud83d\udd17`,`Got it! \u26d3\ufe0f`,`Linked! \ud83c\udfaf`][Math.floor(Math.random()*3)]);if(HIDDEN_SLOTS.every(s=>state.solved[s])){state.gameOver=true;state.won=true;saveStats(true,state.guessesUsed);saveGameState();renderAll();setTimeout(()=>{launchConfetti();showResults()},600);return}state.activeSlot=HIDDEN_SLOTS.find(s=>!state.solved[s])??null}else if(res==='close'){showToast(`Close \u2014 try again! \ud83d\udd25`)}else{showToast(['Not quite...','Nope!','Keep trying!'][Math.floor(Math.random()*3)])}if(state.guessesUsed>=MAX_GUESSES&&!state.won){state.gameOver=true;state.won=false;saveStats(false,state.guessesUsed);saveGameState();renderAll();setTimeout(()=>showResults(),800);return}inp.value='';saveGameState();renderAll()}
let toastTimeout;function showToast(m){const e=document.getElementById('toast');e.textContent=m;e.classList.add('show');clearTimeout(toastTimeout);toastTimeout=setTimeout(()=>e.classList.remove('show'),1800)}
function launchConfetti(){const c=document.getElementById('confetti');c.innerHTML='';const cols=['#D4A843','#4CAF68','#C9A228','#E87040','#6A8FE8','#E85A8F'];for(let i=0;i<60;i++){const p=document.createElement('div');p.className='confetti-piece';p.style.left=Math.random()*100+'%';p.style.backgroundColor=cols[Math.floor(Math.random()*cols.length)];p.style.animationDuration=(1.5+Math.random()*2)+'s';p.style.animationDelay=Math.random()*.6+'s';p.style.borderRadius=Math.random()>.5?'50%':'2px';p.style.width=(6+Math.random()*6)+'px';p.style.height=(6+Math.random()*6)+'px';c.appendChild(p)}setTimeout(()=>c.innerHTML='',4000)}
function getNextPuzzleTimerHTML(){return'<div class="next-puzzle">Next chain in <span class="timer next-timer">--:--:--</span></div>'}
function updateTimers(){const els=document.querySelectorAll('.next-timer');if(!els.length)return;const n=new Date(),tm=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1),d=tm-n;const h=Math.floor(d/36e5),m=Math.floor((d%36e5)/6e4),s=Math.floor((d%6e4)/1e3);const str=`${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;els.forEach(e=>e.textContent=str)}
function showResults(){const mo=document.getElementById('resultsModal'),ov=document.getElementById('resultsOverlay');const ch=state.chain.map((w,i)=>{const ih=HIDDEN_SLOTS.includes(i),ws=state.solved[i];let cl='given';if(ih&&ws)cl='found';else if(ih&&!ws)cl='missed';return`<span class="result-word ${cl}">${w}</span>`}).join('<span class="result-arrow">\u2192</span>');const fc=HIDDEN_SLOTS.filter(s=>state.solved[s]).length;let msg;if(state.won){if(state.guessesUsed<=3)msg='FLAWLESS! \ud83c\udfc6';else if(state.guessesUsed<=5)msg='Brilliant! \u2b50';else if(state.guessesUsed<=7)msg='Well done! \ud83d\udd17';else if(state.guessesUsed<=9)msg='Nice save! \ud83d\udd17';else msg='Just made it! \ud83d\ude05'}else msg=`Found ${fc}/3 \ud83d\udc94`;const st=loadStats();mo.innerHTML=`<button class="modal-close" onclick="closeOverlay('resultsOverlay')">\u00d7</button><h2>${state.won?'Chain Complete!':'Chain Broken'}</h2><div class="result-message">${msg}</div><div class="result-chain">${ch}</div><h3>Your Guesses</h3><div style="display:flex;gap:4px;justify-content:center;margin:4px 0 10px">${state.guesses.map(g=>g.result==='correct'?'<span style="font-size:20px">\ud83d\udfe9</span>':g.result==='close'?'<span style="font-size:20px">\ud83d\udfe8</span>':'<span style="font-size:20px">\ud83d\udfe5</span>').join('')}</div><h3>Statistics</h3><div class="stats-grid"><div class="stat-item"><div class="stat-value">${st.played}</div><div class="stat-label">Played</div></div><div class="stat-item"><div class="stat-value">${st.played?Math.round(st.won/st.played*100):0}%</div><div class="stat-label">Win Rate</div></div><div class="stat-item"><div class="stat-value">${st.currentStreak}${st.currentStreak>=3?' \ud83d\udd25':''}</div><div class="stat-label">Streak</div></div><div class="stat-item"><div class="stat-value">${st.maxStreak}</div><div class="stat-label">Best</div></div></div>${getNextPuzzleTimerHTML()}<button class="share-btn" onclick="shareResults()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>Share Result</button>`;ov.classList.add('show');updateTimers()}
function generateShareText(){const pn=state.puzzleIndex+1,fc=HIDDEN_SLOTS.filter(s=>state.solved[s]).length;let er=state.guesses.map(g=>g.result==='correct'?'\ud83d\udfe9':g.result==='close'?'\ud83d\udfe8':'\ud83d\udfe5').join('');const f=state.chain[0].toUpperCase(),l=state.chain[4].toUpperCase();return`\ud83d\udd17 CHAIN #${pn} \u2014 ${state.won?state.guessesUsed+'/'+MAX_GUESSES+' guesses':fc+'/3 found'}\n\n${f} \u2192 ??? \u2192 ??? \u2192 ??? \u2192 ${l}\n${er}\n\nkevinquigley.net/chains`}
function shareResults(){const t=generateShareText();if(navigator.share)navigator.share({text:t}).catch(()=>fallbackCopy(t));else fallbackCopy(t)}
function fallbackCopy(t){navigator.clipboard.writeText(t).then(()=>showToast('Copied to clipboard!')).catch(()=>showToast('Could not copy'))}
function showStats(){const st=loadStats(),mo=document.getElementById('statsModal'),md=Math.max(1,...Object.values(st.guessDistribution)),tg=state.gameOver&&state.won?state.guessesUsed:null;let dh='';for(let i=3;i<=10;i++){const c=st.guessDistribution[i]||0,p=Math.max(8,c/md*100);dh+=`<div class="dist-row"><span class="dist-label">${i}</span><div class="dist-bar ${tg===i?'highlight':''}" style="width:${p}%">${c}</div></div>`}mo.innerHTML=`<button class="modal-close" onclick="closeOverlay('statsOverlay')">\u00d7</button><h2>Statistics</h2><div class="stats-grid"><div class="stat-item"><div class="stat-value">${st.played}</div><div class="stat-label">Played</div></div><div class="stat-item"><div class="stat-value">${st.played?Math.round(st.won/st.played*100):0}%</div><div class="stat-label">Win Rate</div></div><div class="stat-item"><div class="stat-value">${st.currentStreak}${st.currentStreak>=3?' \ud83d\udd25':''}</div><div class="stat-label">Streak</div></div><div class="stat-item"><div class="stat-value">${st.maxStreak}</div><div class="stat-label">Best</div></div></div><h3>Guess Distribution</h3>${dh}${state.gameOver?getNextPuzzleTimerHTML():''}${state.gameOver?'<button class="share-btn" onclick="shareResults()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>Share Result</button>':''}`;document.getElementById('statsOverlay').classList.add('show');updateTimers()}
function showHelp(){document.getElementById('helpModal').innerHTML=`<button class="modal-close" onclick="closeOverlay('helpOverlay')">\u00d7</button><h2>How to Play</h2><div class="how-section"><div class="how-text"><p>Find the <strong>3 hidden words</strong> that complete the chain. Each pair of adjacent words forms a <strong>compound word</strong> or common phrase.</p></div><div class="how-example"><div class="how-chain"><span class="how-word given">fire</span><span class="result-arrow">\u2192</span><span class="how-word answer">truck</span><span class="result-arrow">\u2192</span><span class="how-word answer">stop</span><span class="result-arrow">\u2192</span><span class="how-word answer">watch</span><span class="result-arrow">\u2192</span><span class="how-word given">tower</span></div><div style="font-size:12px;color:var(--text-dim);text-align:center;margin-top:6px">fire<strong style="color:var(--correct)">truck</strong> \u00b7 truck<strong style="color:var(--correct)">stop</strong> \u00b7 stop<strong style="color:var(--correct)">watch</strong> \u00b7 watch<strong style="color:var(--correct)">tower</strong></div></div><div class="how-text"><p>You get <strong>10 guesses</strong> to find all 3 words. Tap a slot, type your guess, and you'll get feedback:</p></div><div class="how-feedback"><div class="how-fb-row"><span class="how-fb-emoji">\ud83d\udfe9</span><span class="how-fb-text"><strong>Correct!</strong> The word is part of the chain.</span></div><div class="how-fb-row"><span class="how-fb-emoji">\ud83d\udfe8</span><span class="how-fb-text"><strong>Close.</strong> Forms a compound word with one neighbor, but not the other.</span></div><div class="how-fb-row"><span class="how-fb-emoji">\ud83d\udfe5</span><span class="how-fb-text"><strong>Wrong.</strong> Doesn't connect with either neighbor.</span></div></div><div class="how-text"><p style="color:var(--text-dim);font-size:13px">A new chain appears every day at midnight. Good luck! \ud83d\udd17</p></div></div>`;document.getElementById('helpOverlay').classList.add('show')}
function closeOverlay(id){document.getElementById(id).classList.remove('show')}
['resultsOverlay','statsOverlay','helpOverlay'].forEach(id=>{document.getElementById(id).addEventListener('click',e=>{if(e.target.id===id)closeOverlay(id)})});
function renderAll(){renderChain();renderGuessCounter();renderGuessHistory();updateInputState()}
function init(){const pi=getTodayPuzzleIndex(),tk=getTodayKey(),sv=loadGameState();state.puzzleIndex=pi;state.chain=PUZZLES[pi];document.getElementById('puzzleLabel').textContent=`Chain #${pi+1}`;if(sv&&sv[tk]){const s=sv[tk];state.guesses=s.guesses||[];state.solved=s.solved||[false,false,false,false,false];state.gameOver=s.gameOver||false;state.won=s.won||false;state.guessesUsed=s.guessesUsed||0}else{state.solved=[true,false,false,false,true];state.guesses=[];state.gameOver=false;state.won=false;state.guessesUsed=0}state.solved[0]=true;state.solved[4]=true;renderAll();if(state.gameOver)setTimeout(()=>showResults(),400);if(!localStorage.getItem('chain_seen_help_v2')){setTimeout(()=>showHelp(),300);localStorage.setItem('chain_seen_help_v2','1')}setInterval(updateTimers,1000);document.getElementById('guessInput').addEventListener('keydown',e=>{if(e.key==='Enter'){e.preventDefault();submitGuess()}});document.getElementById('guessInput').addEventListener('input',e=>{e.target.value=e.target.value.replace(/[^a-zA-Z]/g,'')})}
init();
</script>
</body>
</html>
